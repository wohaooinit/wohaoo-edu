//>>built
define("edu/wohaoo/mobile/ModulesView","dojo/_base/array dijit/registry dojo/query!css3 dojo/_base/connect dojo/_base/declare dijit/_WidgetBase dojo/dom-construct edu/wohaoo/mobile/ItemPageView dojox/mobile/ListItem dojo/domReady!".split(" "),function(g,b,k,h,l,p,q,m,n){return l([m],{listNode:null,courseId:null,paymentDest:null,paymentAmount:null,paymentMessage:null,paymentInput:null,postCreate:function(){this.itemTemplateString="";this.itemClass="module";this.itemMoveTo="modulePage";this.itemTransition=
"slide";this.inherited(arguments)},refresh:function(){this.inherited(arguments);if(this._store&&null!==this._store){var a=this;k(".itemList",this.domNode).forEach(function(b){a.listNode=b});this.query={id:this.itemPrefix+this.dataId,model:"curriculum"};this._store.fetch({query:this.query,queryOptions:{deep:!0},onBegin:function(){a.hideItems()},onComplete:function(b){g.forEach(b,function(b,e){a.courseId=a._store.getValue(b,"course_id");a.paymentDest=a._store.getValue(b,"payment_dest");a.paymentAmount=
a._store.getValue(b,"enroll_fees");a.paymentMessage=a._store.getValue(b,"payment_message");a.paymentInput=a._store.getValue(b,"payment_input")})},onError:function(b){a.alert(a.errors.err102)}});this.query={id:"*",model:"module"};this._store.fetch({query:this.query,queryOptions:{deep:!0},onBegin:function(){a.hideItems()},onComplete:function(e){g.forEach(e,function(d,e){var c=new n({"class":a.itemClass,dataId:a._store.getValue(d,"uniqueid"),variableHeight:!0}),f=a._store.getValue(d,"passed");c.passed=
0;Sys.getUser()&&(f&&c.set("checked","true"),c.passed=f);c.previous=a._store.getValue(d,"previous");c.previous_passed=a._store.getValue(d,"previous_passed");c.placeAt(a.listNode,"last");f=a._store.getValue(d,"name");c.labelNode.innerText=f;c.domNode._clickEvent&&h.disconnect(c.domNode._clickEvent);c.domNode._clickEvent=h.connect(c.domNode,"click",function(c){var e=Sys.getUser(),d=b.byNode(this);if(e)if(a.courseId)if(d.passed)b.byId("dlg_message").show(a.messages.MODULE_IS_COMPLETED);else{debugger;
d.previous&&!d.previous_passed?b.byId("dlg_message").show(a.messages.PREVIOUS_MODULE_MUST_BE_COMPLETED.format(d.previous)):(c=b.byId(a.itemMoveTo),c.set("dataId",d.dataId),c.refresh(),a.moveTo(a.id,a.itemMoveTo,a.itemTransition))}else c.stopPropagation(),c.preventDefault(),b.byId("enroll").set("paymentDest",a.paymentDest),b.byId("enroll").set("paymentMessage",a.paymentMessage),b.byId("enroll").set("paymentAmount",a.paymentAmount),b.byId("enroll").set("paymentInput",a.paymentInput),b.byId("dlg_join_curriculum").show();
else c.stopPropagation(),c.preventDefault(),b.byId("dlg_login_register").show()})})},onError:function(b){a.alert(a.errors.err102)}})}},showView:function(a,e,d){b.byId(a).hide();a=b.byId(e);a.set("redirectTo",this.id);a.set("dataId",this.dataId);a.animate();this.moveTo(this.id,e,d)}})});
//@ sourceMappingURL=ModulesView.js.map